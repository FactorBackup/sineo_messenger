{"version":3,"sources":["./src/pages/messages/components/message/message.component.html","./src/pages/messages/components/messages/messages.component.html","./src/pages/messages/components/message/message.component.scss","./src/pages/messages/components/message/message.component.ts","./src/pages/messages/components/messages/messages.component.scss","./src/pages/messages/components/messages/messages.component.ts","./src/pages/messages/messages.module.ts","./src/pages/messages/models/message.ts","./src/pages/messages/services/messages/messages.service.ts"],"names":[],"mappings":"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","file":"pages-messages-messages-module-es2015.js","sourcesContent":["module.exports = \"<ion-header>\\r\\n  <ion-toolbar mode=\\\"md\\\">\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-button size=\\\"small\\\" color=\\\"dark\\\" (click)=\\\"closeModal(null, routes.messages)\\\">\\r\\n        <ion-icon src=\\\"assets/icons/arrow-left.svg\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n\\r\\n    <ion-buttons slot=\\\"end\\\">\\r\\n      <ion-button color=\\\"dark\\\" (click)=\\\"call()\\\">\\r\\n        <ion-icon src=\\\"assets/icons/phone.svg\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n    <ion-title\\r\\n      ><span>\\r\\n        <div class=\\\"title-img\\\" [image-loader]=\\\"getSender(message)?.photoURL\\\"></div>\\r\\n        {{ getSender(message)?.displayName }}\\r\\n      </span></ion-title\\r\\n    >\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content class=\\\"ion-padding\\\">\\r\\n  <div class=\\\"content-wrapper\\\" *ngIf=\\\"currentUser\\\">\\r\\n    <ng-container *ngIf=\\\"message && message.messages && message.messages.length\\\">\\r\\n      <div\\r\\n        [id]=\\\"last ? 'last-item' : 'item' + i\\\"\\r\\n        *ngFor=\\\"let item of message.messages; let i = index; let last = last\\\"\\r\\n        (press)=\\\"onMessageHold(item)\\\"\\r\\n      >\\r\\n        <div [ngClass]=\\\"item.uid === currentUser.uid ? 'from-me' : 'from-them'\\\">\\r\\n          <!-- message image -->\\r\\n          <div\\r\\n            class=\\\"image\\\"\\r\\n            (click)=\\\"preview(item.images[0])\\\"\\r\\n            *ngIf=\\\"item.images && item.images.length === 1\\\"\\r\\n            [image-loader]=\\\"item.images[0]\\\"\\r\\n          ></div>\\r\\n\\r\\n          <!-- message image group -->\\r\\n          <div class=\\\"image-group\\\" *ngIf=\\\"item.images && item.images.length > 1\\\">\\r\\n            <div class=\\\"image-group-image\\\" (click)=\\\"preview(image)\\\" *ngFor=\\\"let image of item.images\\\" [image-loader]=\\\"image\\\"></div>\\r\\n          </div>\\r\\n\\r\\n          <!-- message content -->\\r\\n          <div\\r\\n            *ngIf=\\\"item.value\\\"\\r\\n            class=\\\"text\\\"\\r\\n            [innerHTML]=\\\"item.value.length > 100 && !item.readMore ? (item.value | slice: 0:100) : (item.value | markdown)\\\"\\r\\n          >\\r\\n            <!-- read more anchor link -->\\r\\n            <small>\\r\\n              <a *ngIf=\\\"item.value && item.value.length > 100\\\" (click)=\\\"item.readMore = !item.readMore\\\">\\r\\n                {{ 'message-component.read-more' | translate }}\\r\\n              </a>\\r\\n            </small>\\r\\n          </div>\\r\\n        </div>\\r\\n\\r\\n        <div class=\\\"clear\\\"></div>\\r\\n      </div>\\r\\n    </ng-container>\\r\\n\\r\\n    <app-no-data [config]=\\\"noDataconfig\\\" *ngIf=\\\"message && message.messages && message.messages.length === 0\\\"> </app-no-data>\\r\\n  </div>\\r\\n</ion-content>\\r\\n\\r\\n<ion-footer>\\r\\n  <ion-toolbar class=\\\"custom-form\\\">\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-button class=\\\"circle\\\" fill=\\\"clear\\\" color=\\\"primary\\\" (click)=\\\"sendPhoto()\\\">\\r\\n        <ion-icon src=\\\"assets/icons/camera.svg\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n\\r\\n    <textarea\\r\\n      autosize\\r\\n      maxrow=\\\"4\\\"\\r\\n      useImportant=\\\"true\\\"\\r\\n      name=\\\"message\\\"\\r\\n      placeholder=\\\"{{ 'message-component.placeholder' | translate }}\\\"\\r\\n      [(ngModel)]=\\\"textMsg\\\"\\r\\n    ></textarea>\\r\\n\\r\\n    <ion-buttons slot=\\\"end\\\">\\r\\n      <ion-button class=\\\"circle\\\" fill=\\\"clear\\\" color=\\\"primary\\\" (click)=\\\"send(textMsg)\\\">\\r\\n        <ion-icon src=\\\"assets/icons/send.svg\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n  </ion-toolbar>\\r\\n</ion-footer>\\r\\n\\r\\n<!-- <app-spinner *ngIf=\\\"loading\\\"></app-spinner> -->\\r\\n\\r\\n<!-- required for browser file upload -->\\r\\n<input hidden #fileInputButton type=\\\"file\\\" (change)=\\\"detectFiles($event)\\\" multiple />\\r\\n\\r\\n<!-- call user with hidden a tag -->\\r\\n<a hidden #callNumber href=\\\"tel:+{{ getSender(message)?.mobile || getSender(message)?.phone }}\\\"></a>\\r\\n\"","module.exports = \"<ion-toolbar>\\r\\n  <ion-buttons slot=\\\"start\\\">\\r\\n    <ion-menu-button size=\\\"small\\\" autoHide=\\\"true\\\"></ion-menu-button>\\r\\n  </ion-buttons>\\r\\n</ion-toolbar>\\r\\n\\r\\n<ion-content scrollX=\\\"false\\\" scrollY=\\\"false\\\">\\r\\n  <!-- <img src=\\\"../../../../assets/images/new/Background1.jpg\\\" id=\\\"bg\\\" alt=\\\"\\\"> -->\\r\\n  <div class=\\\"content-wrapper\\\">\\r\\n    <!-- start header -->\\r\\n    <div class=\\\"header no-border has-toolbar\\\">\\r\\n      <div class=\\\"title\\\">\\r\\n        {{ 'messages-component.title' | translate }}\\r\\n      </div>\\r\\n      <div class=\\\"options\\\">\\r\\n        <ion-button fill=\\\"clear\\\" size=\\\"small\\\" color=\\\"medium\\\" (click)=\\\"openSearch = !openSearch\\\">\\r\\n          <ion-icon mode=\\\"md\\\" name=\\\"search\\\"></ion-icon>\\r\\n        </ion-button>\\r\\n        <ion-button fill=\\\"clear\\\" size=\\\"small\\\" color=\\\"medium\\\" (click)=\\\"messagesOptions()\\\">\\r\\n          <ion-icon mode=\\\"md\\\" name=\\\"more\\\"></ion-icon>\\r\\n        </ion-button>\\r\\n      </div>\\r\\n    </div>\\r\\n    <!-- end header -->\\r\\n\\r\\n    <app-tab-menu [tabs]=\\\"views\\\"></app-tab-menu>\\r\\n    <app-search-bar *ngIf=\\\"openSearch\\\" (event)=\\\"onSearch($event)\\\"></app-search-bar>\\r\\n\\r\\n    <!-- show messages -->\\r\\n    <div class=\\\"content-scroll\\\" *ngIf=\\\"messages.length > 0\\\">\\r\\n      <div class=\\\"messages\\\" *ngFor=\\\"let item of messages\\\">\\r\\n        <!-- selected icon toggle -->\\r\\n        <div class=\\\"action\\\" *ngIf=\\\"getSelection\\\">\\r\\n          <ion-icon\\r\\n            color=\\\"secondary\\\"\\r\\n            (click)=\\\"item.selected = !item.selected\\\"\\r\\n            [src]=\\\"item.selected ? 'assets/icons/check-square.svg' : 'assets/icons/square.svg'\\\"\\r\\n          ></ion-icon>\\r\\n        </div>\\r\\n\\r\\n        <!-- image of receipeint -->\\r\\n        <div\\r\\n          class=\\\"image\\\"\\r\\n          [image-loader]=\\\"getSender(item).photoURL\\\"\\r\\n          (click)=\\\"goto(routes.people, { queryParams: { id: getSender(item).uid } })\\\"\\r\\n        ></div>\\r\\n\\r\\n        <!-- details of chat -->\\r\\n        <div class=\\\"detail\\\" (click)=\\\"openChat(item.id)\\\">\\r\\n          <div class=\\\"name\\\">{{ getSender(item).displayName }}</div>\\r\\n          <div class=\\\"msg\\\">{{ getLastMessage(item)?.value || 'messages-component.start-chatting' | translate }}</div>\\r\\n        </div>\\r\\n\\r\\n        <!--  date and actions button -->\\r\\n        <div class=\\\"date\\\">\\r\\n          <span>{{ item?.updatedAt?.toDate() | amTimeAgo }}</span>\\r\\n          <ion-button fill=\\\"clear\\\" *ngIf=\\\"!getSelection\\\" (click)=\\\"options(item)\\\" color=\\\"medium\\\" size=\\\"small\\\">\\r\\n            <ion-icon name=\\\"more\\\"></ion-icon>\\r\\n          </ion-button>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n\\r\\n    <app-no-data *ngIf=\\\"messages.length === 0\\\"></app-no-data>\\r\\n  </div>\\r\\n</ion-content>\\r\\n\\r\\n<!-- footer with buttons when you select more than one item -->\\r\\n<ion-footer *ngIf=\\\"getSelection\\\">\\r\\n  <div class=\\\"buttons\\\">\\r\\n    <ion-button size=\\\"small\\\" (click)=\\\"markAsRead()\\\">Mark as Read</ion-button>\\r\\n    <ion-button size=\\\"small\\\" (click)=\\\"archieve()\\\" color=\\\"secondary\\\">Archieve</ion-button>\\r\\n    <ion-button size=\\\"small\\\" (click)=\\\"deleteSelected()\\\" color=\\\"danger\\\">Delete</ion-button>\\r\\n    <ion-button (click)=\\\"getSelection = false\\\" color=\\\"dark\\\" fill=\\\"clear\\\">\\r\\n      <ion-icon src=\\\"assets/icons/x.svg\\\"></ion-icon>\\r\\n    </ion-button>\\r\\n  </div>\\r\\n</ion-footer>\\r\\n\"","module.exports = \":host .title-img {\\n  width: 30px;\\n  height: 30px;\\n  border-radius: 50%;\\n  background-size: contain !important;\\n  background-color: var(--ion-color-light-shade);\\n  margin-right: 10px;\\n  border: 1px solid var(--ion-color-light-shade);\\n}\\n:host .clear {\\n  clear: both;\\n}\\n:host .content-wrapper {\\n  height: 100%;\\n}\\n:host .content-wrapper .from-me,\\n:host .content-wrapper .from-them {\\n  position: relative;\\n  border-radius: 1em;\\n  margin: 10px 0;\\n  overflow: hidden;\\n}\\n:host .content-wrapper .from-me .image,\\n:host .content-wrapper .from-them .image {\\n  width: 200px;\\n  height: 200px;\\n}\\n:host .content-wrapper .from-me .image-group,\\n:host .content-wrapper .from-them .image-group {\\n  display: grid;\\n  grid-template-columns: repeat(2, 1fr);\\n  grid-auto-rows: auto;\\n  grid-gap: 0.5rem;\\n  padding: 10px 10px 5px;\\n  border-top-left-radius: 1em;\\n}\\n:host .content-wrapper .from-me .image-group .image-group-image,\\n:host .content-wrapper .from-them .image-group .image-group-image {\\n  height: 100px;\\n  width: 100px;\\n  border: 1px solid var(--ion-color-medium);\\n  border-radius: 1em;\\n}\\n:host .content-wrapper .from-me .text,\\n:host .content-wrapper .from-them .text {\\n  padding: 10px 20px;\\n  margin: 0;\\n}\\n:host .content-wrapper .from-me .text ::ng-deep p,\\n:host .content-wrapper .from-them .text ::ng-deep p {\\n  margin: 0;\\n}\\n:host .content-wrapper .from-me .text ::ng-deep a,\\n:host .content-wrapper .from-them .text ::ng-deep a {\\n  color: var(--ion-color-primary);\\n}\\n:host .content-wrapper .from-me {\\n  color: var(--ion-color-dark);\\n  background: var(--ion-color-light-shade);\\n  border-top-right-radius: 0px;\\n  float: right;\\n}\\n:host .content-wrapper .from-them {\\n  background: var(--ion-color-gradient);\\n  border-top-left-radius: 0px;\\n  color: var(--ion-color-light);\\n  float: left;\\n}\\n:host ion-footer textarea {\\n  padding: 5px 10px;\\n  overflow: hidden;\\n  height: 40px !important;\\n  width: calc(100% - 20px);\\n  border: 1px solid var(--ion-color-medium);\\n  outline: none;\\n  resize: none;\\n  margin: 5px 10px 0px;\\n  border-radius: 3px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9uZW8vRGVza3RvcC9kZXYvbWVzc2FnZXJfMi9zcmMvcGFnZXMvbWVzc2FnZXMvY29tcG9uZW50cy9tZXNzYWdlL21lc3NhZ2UuY29tcG9uZW50LnNjc3MiLCJzcmMvcGFnZXMvbWVzc2FnZXMvY29tcG9uZW50cy9tZXNzYWdlL21lc3NhZ2UuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0U7RUFDRSxXQUFBO0VBQ0EsWUFBQTtFQUNBLGtCQUFBO0VBQ0EsbUNBQUE7RUFDQSw4Q0FBQTtFQUNBLGtCQUFBO0VBQ0EsOENBQUE7QUNBSjtBREVFO0VBQ0UsV0FBQTtBQ0FKO0FER0U7RUFDRSxZQUFBO0FDREo7QURHSTs7RUFFRSxrQkFBQTtFQUNBLGtCQUFBO0VBQ0EsY0FBQTtFQUNBLGdCQUFBO0FDRE47QURHTTs7RUFDRSxZQUFBO0VBQ0EsYUFBQTtBQ0FSO0FER007O0VBQ0UsYUFBQTtFQUNBLHFDQUFBO0VBQ0Esb0JBQUE7RUFDQSxnQkFBQTtFQUNBLHNCQUFBO0VBQ0EsMkJBQUE7QUNBUjtBREVROztFQUNFLGFBQUE7RUFDQSxZQUFBO0VBQ0EseUNBQUE7RUFDQSxrQkFBQTtBQ0NWO0FER007O0VBQ0Usa0JBQUE7RUFDQSxTQUFBO0FDQVI7QURHVTs7RUFDRSxTQUFBO0FDQVo7QURHVTs7RUFDRSwrQkFBQTtBQ0FaO0FETUk7RUFDRSw0QkFBQTtFQUNBLHdDQUFBO0VBQ0EsNEJBQUE7RUFDQSxZQUFBO0FDSk47QURPSTtFQUNFLHFDQUFBO0VBQ0EsMkJBQUE7RUFDQSw2QkFBQTtFQUNBLFdBQUE7QUNMTjtBRFVJO0VBQ0UsaUJBQUE7RUFDQSxnQkFBQTtFQUNBLHVCQUFBO0VBQ0Esd0JBQUE7RUFDQSx5Q0FBQTtFQUNBLGFBQUE7RUFDQSxZQUFBO0VBQ0Esb0JBQUE7RUFDQSxrQkFBQTtBQ1JOIiwiZmlsZSI6InNyYy9wYWdlcy9tZXNzYWdlcy9jb21wb25lbnRzL21lc3NhZ2UvbWVzc2FnZS5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IHtcclxuICAudGl0bGUtaW1nIHtcclxuICAgIHdpZHRoOiAzMHB4O1xyXG4gICAgaGVpZ2h0OiAzMHB4O1xyXG4gICAgYm9yZGVyLXJhZGl1czogNTAlO1xyXG4gICAgYmFja2dyb3VuZC1zaXplOiBjb250YWluICFpbXBvcnRhbnQ7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1pb24tY29sb3ItbGlnaHQtc2hhZGUpO1xyXG4gICAgbWFyZ2luLXJpZ2h0OiAxMHB4O1xyXG4gICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0taW9uLWNvbG9yLWxpZ2h0LXNoYWRlKTtcclxuICB9XHJcbiAgLmNsZWFyIHtcclxuICAgIGNsZWFyOiBib3RoO1xyXG4gIH1cclxuXHJcbiAgLmNvbnRlbnQtd3JhcHBlciB7XHJcbiAgICBoZWlnaHQ6IDEwMCU7XHJcblxyXG4gICAgLmZyb20tbWUsXHJcbiAgICAuZnJvbS10aGVtIHtcclxuICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG4gICAgICBib3JkZXItcmFkaXVzOiAxZW07XHJcbiAgICAgIG1hcmdpbjogMTBweCAwO1xyXG4gICAgICBvdmVyZmxvdzogaGlkZGVuO1xyXG5cclxuICAgICAgLmltYWdlIHtcclxuICAgICAgICB3aWR0aDogMjAwcHg7XHJcbiAgICAgICAgaGVpZ2h0OiAyMDBweDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLmltYWdlLWdyb3VwIHtcclxuICAgICAgICBkaXNwbGF5OiBncmlkO1xyXG4gICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KDIsIDFmcik7XHJcbiAgICAgICAgZ3JpZC1hdXRvLXJvd3M6IGF1dG87XHJcbiAgICAgICAgZ3JpZC1nYXA6IDAuNXJlbTtcclxuICAgICAgICBwYWRkaW5nOiAxMHB4IDEwcHggNXB4O1xyXG4gICAgICAgIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6IDFlbTtcclxuXHJcbiAgICAgICAgLmltYWdlLWdyb3VwLWltYWdlIHtcclxuICAgICAgICAgIGhlaWdodDogMTAwcHg7XHJcbiAgICAgICAgICB3aWR0aDogMTAwcHg7XHJcbiAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1pb24tY29sb3ItbWVkaXVtKTtcclxuICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDFlbTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC50ZXh0IHtcclxuICAgICAgICBwYWRkaW5nOiAxMHB4IDIwcHg7XHJcbiAgICAgICAgbWFyZ2luOiAwO1xyXG5cclxuICAgICAgICA6Om5nLWRlZXAge1xyXG4gICAgICAgICAgcCB7XHJcbiAgICAgICAgICAgIG1hcmdpbjogMDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBhIHtcclxuICAgICAgICAgICAgY29sb3I6IHZhcigtLWlvbi1jb2xvci1wcmltYXJ5KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAuZnJvbS1tZSB7XHJcbiAgICAgIGNvbG9yOiB2YXIoLS1pb24tY29sb3ItZGFyayk7XHJcbiAgICAgIGJhY2tncm91bmQ6IHZhcigtLWlvbi1jb2xvci1saWdodC1zaGFkZSk7XHJcbiAgICAgIGJvcmRlci10b3AtcmlnaHQtcmFkaXVzOiAwcHg7XHJcbiAgICAgIGZsb2F0OiByaWdodDtcclxuICAgIH1cclxuXHJcbiAgICAuZnJvbS10aGVtIHtcclxuICAgICAgYmFja2dyb3VuZDogdmFyKC0taW9uLWNvbG9yLWdyYWRpZW50KTtcclxuICAgICAgYm9yZGVyLXRvcC1sZWZ0LXJhZGl1czogMHB4O1xyXG4gICAgICBjb2xvcjogdmFyKC0taW9uLWNvbG9yLWxpZ2h0KTtcclxuICAgICAgZmxvYXQ6IGxlZnQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBpb24tZm9vdGVyIHtcclxuICAgIHRleHRhcmVhIHtcclxuICAgICAgcGFkZGluZzogNXB4IDEwcHg7XHJcbiAgICAgIG92ZXJmbG93OiBoaWRkZW47XHJcbiAgICAgIGhlaWdodDogNDBweCAhaW1wb3J0YW50O1xyXG4gICAgICB3aWR0aDogY2FsYygxMDAlIC0gMjBweCk7XHJcbiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWlvbi1jb2xvci1tZWRpdW0pO1xyXG4gICAgICBvdXRsaW5lOiBub25lO1xyXG4gICAgICByZXNpemU6IG5vbmU7XHJcbiAgICAgIG1hcmdpbjogNXB4IDEwcHggMHB4O1xyXG4gICAgICBib3JkZXItcmFkaXVzOiAzcHg7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsIjpob3N0IC50aXRsZS1pbWcge1xuICB3aWR0aDogMzBweDtcbiAgaGVpZ2h0OiAzMHB4O1xuICBib3JkZXItcmFkaXVzOiA1MCU7XG4gIGJhY2tncm91bmQtc2l6ZTogY29udGFpbiAhaW1wb3J0YW50O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1pb24tY29sb3ItbGlnaHQtc2hhZGUpO1xuICBtYXJnaW4tcmlnaHQ6IDEwcHg7XG4gIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWlvbi1jb2xvci1saWdodC1zaGFkZSk7XG59XG46aG9zdCAuY2xlYXIge1xuICBjbGVhcjogYm90aDtcbn1cbjpob3N0IC5jb250ZW50LXdyYXBwZXIge1xuICBoZWlnaHQ6IDEwMCU7XG59XG46aG9zdCAuY29udGVudC13cmFwcGVyIC5mcm9tLW1lLFxuOmhvc3QgLmNvbnRlbnQtd3JhcHBlciAuZnJvbS10aGVtIHtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICBib3JkZXItcmFkaXVzOiAxZW07XG4gIG1hcmdpbjogMTBweCAwO1xuICBvdmVyZmxvdzogaGlkZGVuO1xufVxuOmhvc3QgLmNvbnRlbnQtd3JhcHBlciAuZnJvbS1tZSAuaW1hZ2UsXG46aG9zdCAuY29udGVudC13cmFwcGVyIC5mcm9tLXRoZW0gLmltYWdlIHtcbiAgd2lkdGg6IDIwMHB4O1xuICBoZWlnaHQ6IDIwMHB4O1xufVxuOmhvc3QgLmNvbnRlbnQtd3JhcHBlciAuZnJvbS1tZSAuaW1hZ2UtZ3JvdXAsXG46aG9zdCAuY29udGVudC13cmFwcGVyIC5mcm9tLXRoZW0gLmltYWdlLWdyb3VwIHtcbiAgZGlzcGxheTogZ3JpZDtcbiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoMiwgMWZyKTtcbiAgZ3JpZC1hdXRvLXJvd3M6IGF1dG87XG4gIGdyaWQtZ2FwOiAwLjVyZW07XG4gIHBhZGRpbmc6IDEwcHggMTBweCA1cHg7XG4gIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6IDFlbTtcbn1cbjpob3N0IC5jb250ZW50LXdyYXBwZXIgLmZyb20tbWUgLmltYWdlLWdyb3VwIC5pbWFnZS1ncm91cC1pbWFnZSxcbjpob3N0IC5jb250ZW50LXdyYXBwZXIgLmZyb20tdGhlbSAuaW1hZ2UtZ3JvdXAgLmltYWdlLWdyb3VwLWltYWdlIHtcbiAgaGVpZ2h0OiAxMDBweDtcbiAgd2lkdGg6IDEwMHB4O1xuICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1pb24tY29sb3ItbWVkaXVtKTtcbiAgYm9yZGVyLXJhZGl1czogMWVtO1xufVxuOmhvc3QgLmNvbnRlbnQtd3JhcHBlciAuZnJvbS1tZSAudGV4dCxcbjpob3N0IC5jb250ZW50LXdyYXBwZXIgLmZyb20tdGhlbSAudGV4dCB7XG4gIHBhZGRpbmc6IDEwcHggMjBweDtcbiAgbWFyZ2luOiAwO1xufVxuOmhvc3QgLmNvbnRlbnQtd3JhcHBlciAuZnJvbS1tZSAudGV4dCA6Om5nLWRlZXAgcCxcbjpob3N0IC5jb250ZW50LXdyYXBwZXIgLmZyb20tdGhlbSAudGV4dCA6Om5nLWRlZXAgcCB7XG4gIG1hcmdpbjogMDtcbn1cbjpob3N0IC5jb250ZW50LXdyYXBwZXIgLmZyb20tbWUgLnRleHQgOjpuZy1kZWVwIGEsXG46aG9zdCAuY29udGVudC13cmFwcGVyIC5mcm9tLXRoZW0gLnRleHQgOjpuZy1kZWVwIGEge1xuICBjb2xvcjogdmFyKC0taW9uLWNvbG9yLXByaW1hcnkpO1xufVxuOmhvc3QgLmNvbnRlbnQtd3JhcHBlciAuZnJvbS1tZSB7XG4gIGNvbG9yOiB2YXIoLS1pb24tY29sb3ItZGFyayk7XG4gIGJhY2tncm91bmQ6IHZhcigtLWlvbi1jb2xvci1saWdodC1zaGFkZSk7XG4gIGJvcmRlci10b3AtcmlnaHQtcmFkaXVzOiAwcHg7XG4gIGZsb2F0OiByaWdodDtcbn1cbjpob3N0IC5jb250ZW50LXdyYXBwZXIgLmZyb20tdGhlbSB7XG4gIGJhY2tncm91bmQ6IHZhcigtLWlvbi1jb2xvci1ncmFkaWVudCk7XG4gIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6IDBweDtcbiAgY29sb3I6IHZhcigtLWlvbi1jb2xvci1saWdodCk7XG4gIGZsb2F0OiBsZWZ0O1xufVxuOmhvc3QgaW9uLWZvb3RlciB0ZXh0YXJlYSB7XG4gIHBhZGRpbmc6IDVweCAxMHB4O1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICBoZWlnaHQ6IDQwcHggIWltcG9ydGFudDtcbiAgd2lkdGg6IGNhbGMoMTAwJSAtIDIwcHgpO1xuICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1pb24tY29sb3ItbWVkaXVtKTtcbiAgb3V0bGluZTogbm9uZTtcbiAgcmVzaXplOiBub25lO1xuICBtYXJnaW46IDVweCAxMHB4IDBweDtcbiAgYm9yZGVyLXJhZGl1czogM3B4O1xufSJdfQ== */\"","import { AfterContentChecked, Component, ElementRef, Injector, OnInit, ViewChild } from '@angular/core';\r\nimport { NavParams } from '@ionic/angular';\r\nimport { messages } from 'src/assets/data/message';\r\nimport { IUser } from 'src/pages/auth/helpers/model';\r\nimport { AuthService } from 'src/pages/auth/services/auth/auth.service';\r\nimport { SettingService } from 'src/pages/setting/services/setting/setting.service';\r\nimport { INoData } from 'src/shared/components/no-data/no-data.component';\r\nimport { Extender } from 'src/shared/helpers/extender';\r\nimport { GalleryPickerComponent } from 'src/shared/modals/gallery-picker/gallery-picker.component';\r\nimport { ImagePreviewComponent } from 'src/shared/modals/image-preview/image-preview.component';\r\nimport { CommonService } from 'src/shared/services/common/common.service';\r\nimport { FirestoreService } from 'src/shared/services/firestore/firestore.service';\r\nimport { CHAT_TYPES, IChat, IMessage } from '../../models/message';\r\nimport { MessagesService } from '../../services/messages/messages.service';\r\n//import translate, { setCORS } from \"google-translate-api-browser\";\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\n//import { safeEval } from 'safe-eval';\r\n\r\n/**\r\n * send messages between users. as a user, you can deactivate autoreply in setting page.\r\n * or remove autoreply method and all calls to it.\r\n * sending a message updates messages.message property with the latest message.\r\n * a function in firebase cloud functions checks every message update and sends a push notification to the device\r\n * check readme for info on cloud functions\r\n */\r\n@Component({\r\n  selector: 'app-message',\r\n  templateUrl: './message.component.html',\r\n  styleUrls: ['./message.component.scss']\r\n})\r\nexport class MessageComponent extends Extender implements OnInit, AfterContentChecked {\r\n  public message: IMessage;\r\n  public currentUser: IUser;\r\n  public chat: IChat[] = [];\r\n  public chatType = CHAT_TYPES;\r\n  public textMsg: string = '';\r\n  public images: string[] = [];\r\n  public sendLoading: boolean;\r\n  public translated: string = '';\r\n  public noDataconfig: INoData = {\r\n    content: { title: 'Its quite here', description: 'start a conversation' }\r\n  };\r\n  @ViewChild('content', null) public content: ElementRef;\r\n  @ViewChild('callNumber', null) public callNumber: ElementRef;\r\n  @ViewChild('fileInputButton', null) private fileInputButton: ElementRef;\r\n\r\n  constructor(\r\n    protected injector: Injector,\r\n    private http: HttpClient,\r\n    private navParams: NavParams,\r\n    private authService: AuthService,\r\n    private commonService: CommonService,\r\n    private firestoreService: FirestoreService,\r\n    private messageService: MessagesService,\r\n    private settingService: SettingService\r\n  ) {\r\n    super(injector);\r\n  }\r\n\r\n  public async ngOnInit() {\r\n    this.loading = true;\r\n    this.currentUser = await this.authService.getUser();\r\n    this.subscriptions.push(\r\n      this.messageService.getMessage(this.navParams.get('data')).subscribe(\r\n        (msg) => {\r\n          this.message = msg;\r\n          this.chat = this.message.messages;\r\n          this.loading = false;\r\n        },\r\n        (err) => {\r\n          this.loading = false;\r\n          this.toast(err);\r\n        }\r\n      )\r\n    )\r\n      }\r\n/*\r\n// or\r\nimport translate, { setCORS } from \"google-translate-api-browser\";\r\nsetCORS(\"http://cors-anywhere.herokuapp.com/\");\r\n*/\r\n\r\n\r\n  /** scroll to bottom when view loads with messages */\r\n  public ngAfterContentChecked() {\r\n    this.scrollToBottom();\r\n  }\r\n\r\n  /**\r\n   * used in template to retrieve details of receiving user for the message\r\n   * if currentUser's id doesn't match another user in list, get the other users data as a recipient\r\n   */\r\n  public getSender(message: IMessage) {\r\n    return message ? message.participants.find((user: IUser) => user.uid !== this.currentUser.uid) : null;\r\n  }\r\n\r\n  /**\r\n   * used in template to retrieve details of receiving user for the message\r\n   * if currentUser's id match another user in list, get the other users data as a recipient\r\n   */\r\n  public getRecipient(message: IMessage) {\r\n    return message ? message.participants.find((user: IUser) => user.uid === this.currentUser.uid) : null;\r\n  }\r\n\r\n  /** call sender user */\r\n  public call() {\r\n    this.commonService.callUser(this.getSender(this.message).mobile || this.getSender(this.message).phone, this.callNumber);\r\n  }\r\n\r\n  /** on message press show options is action sheet */\r\n  public async onMessageHold(data: IChat) {\r\n    if (data.uid === this.currentUser.uid) {\r\n      const actionSheet = await this.actionSheetCtrl.create({\r\n        header: 'Chat Options',\r\n        buttons: [\r\n          {\r\n            text: 'Delete',\r\n            role: 'Destructive',\r\n            handler: () => {\r\n              this.messageService\r\n                .deleteChat(this.message, data)\r\n                .then(() => this.scrollToBottom())\r\n                .catch((err) => this.failPromise(err));\r\n            }\r\n          },\r\n          {\r\n            text: 'Close',\r\n            role: 'cancel',\r\n            handler: () => {}\r\n          }\r\n        ]\r\n      });\r\n      await actionSheet.present();\r\n    }\r\n  }\r\n\r\n  /** send message, update uid property of message, this is needed to find the sender id and send notifications to recipients via firebase cloud functions */\r\n  public send(text: any, images = null) {\r\n    const data: IChat = {\r\n      images,\r\n      value: text,\r\n      type: this.chatType.TEXT,\r\n      sendAt: Date.now(),\r\n      uid: this.currentUser.uid\r\n    };\r\n    this.sendLoading = true;\r\n    if (text) {\r\n      this.messageService\r\n        .send({ ...this.message }, data)\r\n        .then(() => {\r\n          this.textMsg = '';\r\n          this.sendLoading = false;\r\n         // this.autoReply(messages[this.getRandomInt(1, 50)]);\r\n        })\r\n        .catch((err) => this.failPromise(err));\r\n    }\r\n    this.translated = text;\r\n    this.http.get(\"https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=en&hl=en&dt=at&dt=bd&dt=ex&dt=ld&dt=md&dt=qca&dt=rw&dt=rm&dt=ss&dt=t&ie=UTF-8&oe=UTF-8&otf=1&ssel=0&tsel=0&kc=7&q=\" + this.translated)\r\n    .toPromise().then((tempval) => { this.translated = JSON.stringify(tempval[0][0][0]); }).catch((error) => console.log(error) );\r\n\r\n     setTimeout(() => {\r\n\r\n      const data2: IChat = {\r\n        images,\r\n        value: this.translated,\r\n        type: this.chatType.TEXT,\r\n        sendAt: Date.now(),\r\n        uid: this.currentUser.uid\r\n      };\r\n      this.sendLoading = true;\r\n      if (text) {\r\n        this.messageService\r\n          .send({ ...this.message }, data2)\r\n          .then(() => {\r\n            this.textMsg = '';\r\n            this.sendLoading = false;\r\n           // this.autoReply(messages[this.getRandomInt(1, 50)]);\r\n          })\r\n          .catch((err) => this.failPromise(err));\r\n      }\r\n    }, 1000);\r\n\r\n    this.translated = '';\r\n  }\r\n\r\n\r\n\r\n  /** for browser input file on change, run this method to get base64 string of files\r\n   * and open gallery modal with the images\r\n   */\r\n  public detectFiles(event: any) {\r\n    this.commonService.getImagesFromFiles(event).then((images) => {\r\n      this.openGallery(images);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * open action sheet with photo upload options, either from camera or library\r\n   * and run getPictures method\r\n   */\r\n  public async sendPhoto() {\r\n    const actionSheet = await this.actionSheetCtrl.create({\r\n      header: 'Send Images',\r\n      buttons: [\r\n        {\r\n          text: 'Use Camera',\r\n          handler: () => {\r\n            this.getPictures(1);\r\n          }\r\n        },\r\n        {\r\n          text: 'Use Library',\r\n          handler: () => {\r\n            this.getPictures(0, true);\r\n          }\r\n        },\r\n        {\r\n          text: 'Close',\r\n          role: 'cancel',\r\n          handler: () => {}\r\n        }\r\n      ]\r\n    });\r\n    await actionSheet.present();\r\n  }\r\n\r\n  /** open preview image modal */\r\n  public async preview(image: string) {\r\n    const modal = await this.openModal(ImagePreviewComponent, image);\r\n    modal.present();\r\n  }\r\n\r\n  /** auto reply to message */\r\n /* public autoReply(text: any, images = null) {\r\n    if (this.settingService.setting.autoReply === true) {\r\n      setTimeout(() => {\r\n        const data: IChat = {\r\n          images,\r\n          value: text,\r\n          type: this.chatType.TEXT,\r\n          sendAt: Date.now(),\r\n          uid: this.getSender(this.message).uid\r\n        };\r\n        this.loading = true;\r\n        this.messageService\r\n          .send({ ...this.message }, data)\r\n          .then(() => (this.loading = false))\r\n          .catch((err) => this.failPromise(err));\r\n      }, 6000);\r\n    }\r\n  }*/\r\n\r\n  /**\r\n   * scroll to bottom of chat\r\n   */\r\n  public scrollToBottom(): void {\r\n    const element = document.getElementById('last-item');\r\n    if (element) {\r\n      element.scrollIntoView({\r\n        behavior: 'auto',\r\n        block: 'end',\r\n        inline: 'nearest'\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * get image using native camera plugin to retrieve from either camera or library of device\r\n   * param type is a number that specifies whether to get from camera or from library\r\n   * one image retrieved, upload to firebase storage. if error, display a toast with error message\r\n   */\r\n  private async getPictures(type: number, multiple = false) {\r\n    let imageData = [];\r\n    this.loading = true;\r\n\r\n    if ((window as any).cordova) {\r\n      // if on device use native plugins\r\n      imageData = await this.commonService.getPictures(type, multiple);\r\n      await this.openGallery(imageData);\r\n    } else {\r\n      // if on device use browser file upload\r\n      (this.fileInputButton.nativeElement as HTMLInputElement).click();\r\n    }\r\n  }\r\n\r\n  /** open gallery with image files, on dismiss modal, get images and upload them */\r\n  private async openGallery(imageData: any[]) {\r\n    if (imageData.length > 0) {\r\n      const modal = await this.openModal(GalleryPickerComponent, imageData, 'custom-modal');\r\n      await modal.present();\r\n      const { data } = await modal.onDidDismiss();\r\n      if (data.images && data.images.length > 0) {\r\n        this.uploadImage(data.text, data.images);\r\n      } else {\r\n        this.toast(this.translate.instant('message.component.no-images-selected'));\r\n      }\r\n    }\r\n    (this.fileInputButton.nativeElement as HTMLInputElement).value = null;\r\n  }\r\n\r\n  /**\r\n   * append base 64 string to image data, upload image data to firebase storage.\r\n   * the upload function returns a download data which is then saved to images\r\n   */\r\n  private uploadImage(text: string, imageData: string[]) {\r\n    this.images = imageData;\r\n    const read$ = [];\r\n    this.images.forEach((i) => {\r\n      read$.push(this.firestoreService.uploadImage(i, `${Date.now()}-${this.currentUser.uid}`, 'chat-images'));\r\n    });\r\n\r\n    Promise.all(read$)\r\n      .then((res) => {\r\n        this.images = res;\r\n        this.send(text, this.images);\r\n        this.loading = false;\r\n      })\r\n      .catch((err) => this.failPromise(err));\r\n  }\r\n\r\n  private failPromise = (err: any) => {\r\n    this.loading = false;\r\n    this.sendLoading = false;\r\n    this.toast(err);\r\n  };\r\n}\r\n","module.exports = \":host ion-content .content-wrapper .content-scroll {\\n  padding: 0 20px;\\n}\\n:host ion-content .content-wrapper .content-scroll .messages {\\n  display: -webkit-box;\\n  display: flex;\\n  -webkit-box-align: center;\\n          align-items: center;\\n  margin: 20px 0;\\n}\\n:host ion-content .content-wrapper .content-scroll .messages .image {\\n  height: 60px;\\n  width: 60px;\\n  border-radius: 3px;\\n  box-shadow: 1px 1px 12px var(--ion-color-light-shade);\\n}\\n:host ion-content .content-wrapper .content-scroll .messages .detail {\\n  margin-left: 15px;\\n  -webkit-box-flex: 1;\\n          flex: 1;\\n}\\n:host ion-content .content-wrapper .content-scroll .messages .detail .name {\\n  font-weight: 500;\\n  font-size: 16px;\\n}\\n:host ion-content .content-wrapper .content-scroll .messages .detail .msg {\\n  font-size: 14px;\\n  color: var(--ion-color-medium-shade);\\n  white-space: nowrap;\\n  width: 150px;\\n  text-overflow: ellipsis;\\n  overflow: hidden;\\n}\\n:host ion-content .content-wrapper .content-scroll .messages .date {\\n  width: 63px;\\n  display: -webkit-box;\\n  display: flex;\\n  -webkit-box-orient: vertical;\\n  -webkit-box-direction: normal;\\n          flex-direction: column;\\n  font-size: 10px;\\n  color: var(--ion-color-medium-shade);\\n  overflow: hidden;\\n  white-space: nowrap;\\n}\\n:host ion-content .content-wrapper .content-scroll .messages .action {\\n  margin-right: 15px;\\n}\\n:host ion-footer .buttons {\\n  margin: 5px 0 5px 15px;\\n  display: -webkit-box;\\n  display: flex;\\n  -webkit-box-align: center;\\n          align-items: center;\\n}\\n:host ion-footer .buttons ion-button {\\n  width: 100%;\\n}\\n:host ion-footer .buttons ion-button.right {\\n  float: right;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9uZW8vRGVza3RvcC9kZXYvbWVzc2FnZXJfMi9zcmMvcGFnZXMvbWVzc2FnZXMvY29tcG9uZW50cy9tZXNzYWdlcy9tZXNzYWdlcy5jb21wb25lbnQuc2NzcyIsInNyYy9wYWdlcy9tZXNzYWdlcy9jb21wb25lbnRzL21lc3NhZ2VzL21lc3NhZ2VzLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUdNO0VBQ0UsZUFBQTtBQ0ZSO0FESVE7RUFDRSxvQkFBQTtFQUFBLGFBQUE7RUFDQSx5QkFBQTtVQUFBLG1CQUFBO0VBQ0EsY0FBQTtBQ0ZWO0FESVU7RUFDRSxZQUFBO0VBQ0EsV0FBQTtFQUNBLGtCQUFBO0VBQ0EscURBQUE7QUNGWjtBREtVO0VBQ0UsaUJBQUE7RUFDQSxtQkFBQTtVQUFBLE9BQUE7QUNIWjtBREtZO0VBQ0UsZ0JBQUE7RUFDQSxlQUFBO0FDSGQ7QURNWTtFQUNFLGVBQUE7RUFDQSxvQ0FBQTtFQUNBLG1CQUFBO0VBQ0EsWUFBQTtFQUNBLHVCQUFBO0VBQ0EsZ0JBQUE7QUNKZDtBRFFVO0VBQ0UsV0FBQTtFQUNBLG9CQUFBO0VBQUEsYUFBQTtFQUNBLDRCQUFBO0VBQUEsNkJBQUE7VUFBQSxzQkFBQTtFQUNBLGVBQUE7RUFDQSxvQ0FBQTtFQUNBLGdCQUFBO0VBQ0EsbUJBQUE7QUNOWjtBRFFVO0VBQ0Usa0JBQUE7QUNOWjtBRGFJO0VBQ0Usc0JBQUE7RUFDQSxvQkFBQTtFQUFBLGFBQUE7RUFDQSx5QkFBQTtVQUFBLG1CQUFBO0FDWE47QURZTTtFQUNFLFdBQUE7QUNWUjtBRFdRO0VBQ0UsWUFBQTtBQ1RWIiwiZmlsZSI6InNyYy9wYWdlcy9tZXNzYWdlcy9jb21wb25lbnRzL21lc3NhZ2VzL21lc3NhZ2VzLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiOmhvc3Qge1xyXG4gIGlvbi1jb250ZW50IHtcclxuICAgIC5jb250ZW50LXdyYXBwZXIge1xyXG4gICAgICAuY29udGVudC1zY3JvbGwge1xyXG4gICAgICAgIHBhZGRpbmc6IDAgMjBweDtcclxuXHJcbiAgICAgICAgLm1lc3NhZ2VzIHtcclxuICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gICAgICAgICAgbWFyZ2luOiAyMHB4IDA7XHJcblxyXG4gICAgICAgICAgLmltYWdlIHtcclxuICAgICAgICAgICAgaGVpZ2h0OiA2MHB4O1xyXG4gICAgICAgICAgICB3aWR0aDogNjBweDtcclxuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogM3B4O1xyXG4gICAgICAgICAgICBib3gtc2hhZG93OiAxcHggMXB4IDEycHggdmFyKC0taW9uLWNvbG9yLWxpZ2h0LXNoYWRlKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAuZGV0YWlsIHtcclxuICAgICAgICAgICAgbWFyZ2luLWxlZnQ6IDE1cHg7XHJcbiAgICAgICAgICAgIGZsZXg6IDE7XHJcblxyXG4gICAgICAgICAgICAubmFtZSB7XHJcbiAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDtcclxuICAgICAgICAgICAgICBmb250LXNpemU6IDE2cHg7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC5tc2cge1xyXG4gICAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDtcclxuICAgICAgICAgICAgICBjb2xvcjogdmFyKC0taW9uLWNvbG9yLW1lZGl1bS1zaGFkZSk7XHJcbiAgICAgICAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcclxuICAgICAgICAgICAgICB3aWR0aDogMTUwcHg7XHJcbiAgICAgICAgICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XHJcbiAgICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC5kYXRlIHtcclxuICAgICAgICAgICAgd2lkdGg6IDYzcHg7XHJcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTBweDtcclxuICAgICAgICAgICAgY29sb3I6IHZhcigtLWlvbi1jb2xvci1tZWRpdW0tc2hhZGUpO1xyXG4gICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgLmFjdGlvbiB7XHJcbiAgICAgICAgICAgIG1hcmdpbi1yaWdodDogMTVweDtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgaW9uLWZvb3RlciB7XHJcbiAgICAuYnV0dG9ucyB7XHJcbiAgICAgIG1hcmdpbjogNXB4IDAgNXB4IDE1cHg7XHJcbiAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgICAgIGlvbi1idXR0b24ge1xyXG4gICAgICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgICAgICYucmlnaHQge1xyXG4gICAgICAgICAgZmxvYXQ6IHJpZ2h0O1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCI6aG9zdCBpb24tY29udGVudCAuY29udGVudC13cmFwcGVyIC5jb250ZW50LXNjcm9sbCB7XG4gIHBhZGRpbmc6IDAgMjBweDtcbn1cbjpob3N0IGlvbi1jb250ZW50IC5jb250ZW50LXdyYXBwZXIgLmNvbnRlbnQtc2Nyb2xsIC5tZXNzYWdlcyB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIG1hcmdpbjogMjBweCAwO1xufVxuOmhvc3QgaW9uLWNvbnRlbnQgLmNvbnRlbnQtd3JhcHBlciAuY29udGVudC1zY3JvbGwgLm1lc3NhZ2VzIC5pbWFnZSB7XG4gIGhlaWdodDogNjBweDtcbiAgd2lkdGg6IDYwcHg7XG4gIGJvcmRlci1yYWRpdXM6IDNweDtcbiAgYm94LXNoYWRvdzogMXB4IDFweCAxMnB4IHZhcigtLWlvbi1jb2xvci1saWdodC1zaGFkZSk7XG59XG46aG9zdCBpb24tY29udGVudCAuY29udGVudC13cmFwcGVyIC5jb250ZW50LXNjcm9sbCAubWVzc2FnZXMgLmRldGFpbCB7XG4gIG1hcmdpbi1sZWZ0OiAxNXB4O1xuICBmbGV4OiAxO1xufVxuOmhvc3QgaW9uLWNvbnRlbnQgLmNvbnRlbnQtd3JhcHBlciAuY29udGVudC1zY3JvbGwgLm1lc3NhZ2VzIC5kZXRhaWwgLm5hbWUge1xuICBmb250LXdlaWdodDogNTAwO1xuICBmb250LXNpemU6IDE2cHg7XG59XG46aG9zdCBpb24tY29udGVudCAuY29udGVudC13cmFwcGVyIC5jb250ZW50LXNjcm9sbCAubWVzc2FnZXMgLmRldGFpbCAubXNnIHtcbiAgZm9udC1zaXplOiAxNHB4O1xuICBjb2xvcjogdmFyKC0taW9uLWNvbG9yLW1lZGl1bS1zaGFkZSk7XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG4gIHdpZHRoOiAxNTBweDtcbiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XG4gIG92ZXJmbG93OiBoaWRkZW47XG59XG46aG9zdCBpb24tY29udGVudCAuY29udGVudC13cmFwcGVyIC5jb250ZW50LXNjcm9sbCAubWVzc2FnZXMgLmRhdGUge1xuICB3aWR0aDogNjNweDtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgZm9udC1zaXplOiAxMHB4O1xuICBjb2xvcjogdmFyKC0taW9uLWNvbG9yLW1lZGl1bS1zaGFkZSk7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG59XG46aG9zdCBpb24tY29udGVudCAuY29udGVudC13cmFwcGVyIC5jb250ZW50LXNjcm9sbCAubWVzc2FnZXMgLmFjdGlvbiB7XG4gIG1hcmdpbi1yaWdodDogMTVweDtcbn1cbjpob3N0IGlvbi1mb290ZXIgLmJ1dHRvbnMge1xuICBtYXJnaW46IDVweCAwIDVweCAxNXB4O1xuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xufVxuOmhvc3QgaW9uLWZvb3RlciAuYnV0dG9ucyBpb24tYnV0dG9uIHtcbiAgd2lkdGg6IDEwMCU7XG59XG46aG9zdCBpb24tZm9vdGVyIC5idXR0b25zIGlvbi1idXR0b24ucmlnaHQge1xuICBmbG9hdDogcmlnaHQ7XG59Il19 */\"","import { Component, Injector, OnInit } from '@angular/core';\r\nimport { Subject } from 'rxjs';\r\nimport { switchMap } from 'rxjs/internal/operators/switchMap';\r\nimport { IUser } from 'src/pages/auth/helpers/model';\r\nimport { AuthService } from 'src/pages/auth/services/auth/auth.service';\r\nimport { Extender } from 'src/shared/helpers/extender';\r\nimport { IChat, IMessage } from '../../models/message';\r\nimport { MessagesService } from '../../services/messages/messages.service';\r\nimport { MessageComponent } from '../message/message.component';\r\n\r\n/*\r\n * view users messages, manage messages.\r\n */\r\n@Component({\r\n  selector: 'app-messages',\r\n  templateUrl: './messages.component.html',\r\n  styleUrls: ['./messages.component.scss']\r\n})\r\nexport class MessagesComponent extends Extender implements OnInit {\r\n  public allMessages: IMessage[] = [];\r\n  public messages: IMessage[] = [];\r\n  public currentUser: IUser;\r\n  public getSelection: boolean = false;\r\n  public openSearch: boolean = false;\r\n  public view$ = new Subject<boolean>();\r\n  /** get tab data to use as input for app-tab-menu component */\r\n  public views: IViews[] = [\r\n    {\r\n      id: 0,\r\n      active: true,\r\n      name: this.translate.instant('messages-component.tab-all'),\r\n      event: () => {\r\n        this.view$.next(false);\r\n      }\r\n    },\r\n    {\r\n      id: 2,\r\n      name: this.translate.instant('messages-component.tab-archived'),\r\n      event: () => {\r\n        this.view$.next(true);\r\n      }\r\n    }\r\n  ];\r\n\r\n  constructor(protected injector: Injector, private authService: AuthService, private messageService: MessagesService) {\r\n    super(injector);\r\n  }\r\n\r\n  /**\r\n   * subscribe to view change events from tab component changes,\r\n   * create a switch map to get data based on view change\r\n   * if isArchieved view is clicked show archieved messages\r\n   * emit event for no archieved messages on initialization\r\n   */\r\n  public async ngOnInit() {\r\n    this.currentUser = await this.authService.getUser();\r\n    const queryObservable = this.view$.pipe(switchMap((view) => this.messageService.getMessages(this.currentUser.uid, view)));\r\n    this.subscriptions.push(\r\n      queryObservable.subscribe((queryItems) => {\r\n        this.messages = this.allMessages = queryItems;\r\n      })\r\n    );\r\n    this.view$.next(false);\r\n  }\r\n\r\n  /** on view enter, if route contains an id, open chat belonging to that id in a modal straight away */\r\n  public ionViewDidEnter() {\r\n    const messageId = this.activatedRoute.snapshot.params && this.activatedRoute.snapshot.params.id;\r\n\r\n    if (messageId) {\r\n      this.openChat(messageId);\r\n    }\r\n  }\r\n\r\n  /** search messages by participant name */\r\n  public onSearch(val: string): void {\r\n    if (val && val.trim() !== '') {\r\n      this.messages = this.allMessages.filter((item) => {\r\n        return item.participants.find((user) => user.displayName.toLowerCase().indexOf(val.toLowerCase()) > -1);\r\n      });\r\n    } else {\r\n      this.messages = this.allMessages;\r\n    }\r\n  }\r\n\r\n  /** used in template to retrieve details of receiving user for the message\r\n   * if currentUser's id doesn't match another user in list, get the other users data as a recipient\r\n   */\r\n  public getSender(message: IMessage) {\r\n    return message.participants.find((user: IUser) => user.uid !== this.currentUser.uid);\r\n  }\r\n\r\n  /** get last message sent in conversation or default to start chatting */\r\n  public getLastMessage(message: IMessage): IChat | { value: string } {\r\n    return message.messages && message.messages.length > 0 ? message.messages[message.messages.length - 1] : null;\r\n  }\r\n\r\n  /** open chat in a model */\r\n  public async openChat(message: string) {\r\n    const modal = await this.openModal(MessageComponent, message);\r\n    modal.present();\r\n  }\r\n\r\n  /** action sheet with options for a single chat,\r\n   * allow user to mark message as read, archive chat and delete a chat\r\n   */\r\n  public async options(chat: IMessage) {\r\n    const asCtrl = await this.actionSheetCtrl.create({\r\n      header: this.translate.instant('messages-component.manage-chat'),\r\n      buttons: [\r\n        {\r\n          text: this.translate.instant('messages-component.mark-as-read'),\r\n          handler: () => {\r\n            chat.isRead = true;\r\n            this.messageService.updateMessage(chat);\r\n          }\r\n        },\r\n        {\r\n          text: this.translate.instant('messages-component.archieved'),\r\n          handler: () => {\r\n            chat.isArchieved = true;\r\n            this.messageService.updateMessage(chat);\r\n          }\r\n        },\r\n        {\r\n          text: this.translate.instant('messages-component.delete'),\r\n          handler: () => {\r\n            this.messageService.deleteMessage(chat);\r\n          }\r\n        },\r\n        {\r\n          text: this.translate.instant('other.close'),\r\n          role: 'cancel'\r\n        }\r\n      ]\r\n    });\r\n    asCtrl.present();\r\n  }\r\n\r\n  /** action sheet with options for selected chat,\r\n   * allow user to mark message as read, archive chat and delete a chat\r\n   */\r\n  public async messagesOptions() {\r\n    const asCtrl = await this.actionSheetCtrl.create({\r\n      header: this.translate.instant('messages-component.manage-messages'),\r\n      buttons: [\r\n        {\r\n          text: this.translate.instant('messages-component.select'),\r\n          handler: () => {\r\n            this.getSelection = true;\r\n          }\r\n        },\r\n        {\r\n          text: this.translate.instant('messages-component.select-all'),\r\n          handler: () => {\r\n            this.selectAll();\r\n          }\r\n        },\r\n        {\r\n          text: this.translate.instant('messages-component.delete-all'),\r\n          handler: () => {\r\n            this.messageService.deleteAllMessages(this.messages.length);\r\n          }\r\n        },\r\n        {\r\n          text: this.translate.instant('other.close'),\r\n          role: 'cancel'\r\n        }\r\n      ]\r\n    });\r\n    asCtrl.present();\r\n  }\r\n\r\n  /** mark multiple selected messages as read */\r\n  public markAsRead() {\r\n    const selected = this.messages.filter((msg) => msg.selected === true);\r\n    selected.forEach((item) => {\r\n      item.isRead = true;\r\n      this.messageService.updateMessage(item);\r\n    });\r\n    this.getSelection = false;\r\n  }\r\n\r\n  /** archive multiple messages */\r\n  public archieve() {\r\n    const selected = this.messages.filter((msg) => msg.selected === true);\r\n    selected.forEach((item) => {\r\n      item.isArchieved = true;\r\n      this.messageService.updateMessage(item);\r\n    });\r\n    this.getSelection = false;\r\n  }\r\n\r\n  /** delete selected messages */\r\n  public deleteSelected() {\r\n    const selected = this.messages.filter((msg) => msg.selected === true);\r\n    selected.forEach((item) => {\r\n      this.messageService.deleteMessage(item);\r\n    });\r\n    this.getSelection = false;\r\n  }\r\n\r\n  /** select all messages */\r\n  private selectAll() {\r\n    this.getSelection = true;\r\n    this.messages.map((message) => {\r\n      message.selected = true;\r\n      return message;\r\n    });\r\n  }\r\n}\r\n\r\ninterface IViews {\r\n  id: number;\r\n  name: string;\r\n  active?: boolean;\r\n  event?: any;\r\n}\r\n","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { RouterModule } from '@angular/router';\r\nimport { SharedModule } from 'src/shared/shared.module';\r\nimport { MessageComponent } from './components/message/message.component';\r\nimport { MessagesComponent } from './components/messages/messages.component';\r\n\r\n@NgModule({\r\n  declarations: [MessagesComponent, MessageComponent],\r\n  entryComponents: [MessageComponent],\r\n  imports: [\r\n    CommonModule,\r\n    SharedModule,\r\n    RouterModule.forChild([\r\n      {\r\n        path: '',\r\n        component: MessagesComponent\r\n      },\r\n      {\r\n        path: ':id',\r\n        component: MessagesComponent\r\n      }\r\n    ])\r\n  ]\r\n})\r\nexport class MessagesModule { }\r\n","import { IUser } from 'src/pages/auth/helpers/model';\r\n\r\nexport interface IMessage {\r\n  id?: string;\r\n  participants?: IUser[];\r\n  participantsId: string[] | number[];\r\n  createdAt: firebase.firestore.Timestamp;\r\n  updatedAt: firebase.firestore.Timestamp;\r\n  isRead?: boolean;\r\n  isArchieved?: boolean;\r\n  selected?: boolean;\r\n  messages: IChat[];\r\n  uid: string;\r\n}\r\n\r\nexport interface IChat {\r\n  value: string | string[];\r\n  images?: string[];\r\n  imagesUrl?: any[];\r\n  sendAt: any;\r\n  type: number;\r\n  uid: string;\r\n}\r\n\r\nexport enum CHAT_TYPES {\r\n  TEXT,\r\n  AUDIO,\r\n  IMAGE,\r\n  IMAGE_GROUP,\r\n}\r\n","import { Injectable, Injector } from '@angular/core';\r\nimport * as firebase from 'firebase/app';\r\nimport { combineLatest, Observable, of } from 'rxjs';\r\nimport { map, switchMap } from 'rxjs/operators';\r\nimport { IUser } from 'src/pages/auth/helpers/model';\r\nimport { AuthService } from 'src/pages/auth/services/auth/auth.service';\r\nimport { Extender } from 'src/shared/helpers/extender';\r\nimport { FirestoreService } from 'src/shared/services/firestore/firestore.service';\r\nimport { IChat, IMessage } from '../../models/message';\r\n\r\n/**\r\n * crud methods to interact with firebase cloud store regarding messaging\r\n */\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class MessagesService extends Extender {\r\n  constructor(protected injector: Injector, private authService: AuthService, private firestoreService: FirestoreService) {\r\n    super(injector);\r\n  }\r\n\r\n  /** get messages that contain the users uid in participantsId property, check if message is flagged as archived\r\n   * for each message get messages recipient and get their details from users collection. return data\r\n   */\r\n  public getMessages(uid: string, archieved: boolean = false): Observable<IMessage[]> {\r\n    return this.firestoreService\r\n      .colWithIds$<IMessage[]>('messages', (ref: any) =>\r\n        ref.where('participantsId', 'array-contains', uid).where('isArchieved', '==', archieved)\r\n      )\r\n      .pipe(\r\n        switchMap((data: IMessage[]) => {\r\n          const reads$ = [];\r\n          if (data.length > 0) {\r\n            data.forEach((msg) => {\r\n              reads$.push(this.getMessage(msg.id));\r\n            });\r\n            return combineLatest(reads$);\r\n          } else {\r\n            return of([]);\r\n          }\r\n        }),\r\n        map((data: IMessage[]) => {\r\n          return data;\r\n        })\r\n      );\r\n  }\r\n\r\n  /** get message and their participants information */\r\n  public getMessage(id: string | number): Observable<IMessage> {\r\n    let data: any;\r\n    const reads$ = [];\r\n\r\n    return this.firestoreService.doc$<IMessage>(`messages/${id}`).pipe(\r\n      switchMap((msg) => {\r\n        data = msg;\r\n        msg.participantsId.forEach((i: any) => {\r\n          reads$.push(this.firestoreService.doc$<IUser>(`users/${i}`));\r\n        });\r\n        return combineLatest(reads$);\r\n      }),\r\n      map((joins) => {\r\n        return { ...data, participants: joins };\r\n      })\r\n    );\r\n  }\r\n\r\n  /** update message */\r\n  public updateMessage(message: IMessage) {\r\n    return this.firestoreService.update(`messages/${message.id}`, message);\r\n  }\r\n\r\n  /** delete message */\r\n  public deleteMessage(message: IMessage) {\r\n    return this.firestoreService.delete(`messages/${message.id}`);\r\n  }\r\n\r\n  /** delete collection of messages */\r\n  public deleteAllMessages(batch) {\r\n    return this.firestoreService.deleteCollection(`messages`, batch);\r\n  }\r\n\r\n  /** start chat with a user by first checking if a message already exists with the users id,\r\n   * if no message exists, create one,\r\n   * if message exists, navigate to chat modal\r\n   */\r\n  public async startChat(user: IUser) {\r\n\t\tlet myaccount = await this.authService.getUser();\r\n\t\tthis.firestoreService\r\n\t\t\t.colWithIds$<IMessage>('messages', (ref: any) =>\r\n\t\t\t\tref.where('participantsId', 'array-contains', user.uid)\r\n\t\t\t)\r\n\t\t\t.pipe(\r\n\t\t\t\tmap((data: IMessage[]) => {\r\n\t\t\t\t\tlet temp: IMessage[] = [];\r\n\t\t\t\t\tdata.forEach((element) => {\r\n\t\t\t\t\t\telement.participantsId.forEach((part) => {\r\n\t\t\t\t\t\t\tif (part == myaccount.uid) {\r\n\t\t\t\t\t\t\t\ttemp.push(element);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn temp;\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t\t.subscribe((data) => {\r\n\t\t\t\tconst message = data[0];\r\n\t\t\t\tif (!!message) {\r\n\t\t\t\t\tthis.goto(`${this.routes.messages}/${message.id}`);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.createMessage(user);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n  /** delete a message in chat */\r\n  public deleteChat(message: IMessage, data: IChat) {\r\n    return this.firestoreService.update(`messages/${message.id}`, {\r\n      messages: firebase.firestore.FieldValue.arrayRemove(data)\r\n    });\r\n  }\r\n\r\n  /** send a message */\r\n  public send(message: IMessage, data: IChat) {\r\n    delete message.participants;\r\n    return this.firestoreService.update(`messages/${message.id}`, {\r\n      ...message,\r\n      messages: firebase.firestore.FieldValue.arrayUnion(data)\r\n    });\r\n  }\r\n\r\n  /** create a message with participants and default messages property to empty array */\r\n  private async createMessage(user: IUser) {\r\n    const { uid } = await this.authService.getUser();\r\n    this.firestoreService.add<IMessage>('messages', {\r\n      participantsId: [user.uid, uid],\r\n      messages: [],\r\n      isArchieved: false\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":""}